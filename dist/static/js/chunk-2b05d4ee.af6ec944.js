(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b05d4ee"],{"05ba":function(t,e){var a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(a){var r=new Uint8Array(16);t.exports=function(){return a(r),r}}else{var i=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0===(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}},"2ad4":function(t,e,a){},"42b8":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"material"},[a("c-button",{attrs:{type:"primary"},on:{click:t.showUploadQrcode}},[t._v("微信扫码上传素材")]),a("div",{staticClass:"material-list"},t._l(t.list,function(e){return e.uploaded?a("div",{staticClass:"material-body"},[a("div",{staticClass:"material-item"},[a("div",{staticClass:"material-item-img",style:{"background-image":"url("+e.img+")"}}),a("div",{staticClass:"material-item-handle"},[a("div",{staticClass:"material-item-info"},[t._v("点击添加到画布…")]),a("div",{staticClass:"material-item-save",class:{disabled:e.isSave},on:{click:function(a){return t.save(e)}}},[t._v("保存")])]),a("div",{staticClass:"material-item-btns"},[a("div",{staticClass:"material-item-btn",on:{click:function(a){return t.replaceImage(e.src)}}},[t._v("替换")]),a("div",{staticClass:"material-item-btn",on:{click:function(a){return t.addImage(e.src)}}},[t._v("添加")])])])]):t._e()}),0),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showUpload,expression:"showUpload"}],ref:"upload",staticClass:"material-upload"})],1)},i=[],n=(a("e680"),a("3c6b"),a("7bc1"),a("f763"),a("4453"),a("089b")),s=a("e20c"),o=a("591a"),A=a("880a"),c=a("1638"),l=a("5428"),d=a.n(l),u=a("fd9e"),p={name:"uploadMaterial",data:function(){return{keyword:"",list:[],showUpload:!1,listIndex:0,uploaded:!1}},watch:{confirm:function(t){t&&this.getUploadedImages()}},methods:Object(s["a"])({},Object(o["b"])(["changeUploadedMaterial","changeUploadQrcode","updateHistory"]),{save:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a,r,i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,a=e.src,r=e.isSave,i=void 0!==r&&r,!i){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,this.$axios.get(A["addMaterial"],{params:{img:a}});case 6:n=t.sent,n.data,this.$set(e,"isSave",!0),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),s=t.t0.msg,this.$toast.error(s);case 15:case"end":return t.stop()}},t,this,[[0,11]])}));function e(e){return t.apply(this,arguments)}return e}(),getUploadedImages:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,a,r,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$axios.get(A["uploadedImages"]);case 3:e=t.sent,a=e.data,this.changeUploadedMaterial({show:!1,confirm:!1}),this.uploaded=!1,a.forEach(function(t){t.uploaded=!1,i.list.push(t)}),this.nextUpload(),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),r=t.t0.msg,this.$toast.error(r);case 15:case"end":return t.stop()}},t,this,[[0,11]])}));function e(){return t.apply(this,arguments)}return e}(),nextUpload:function(){try{var t=window.android.getImageBase64Encode(this.list[this.listIndex].img),e=this.dataURLtoBlob(t);this.up.addFile(e),this.up.start()}catch(a){console.log("nextUpload"+a)}},dataURLtoBlob:function(t){var e=t.split(","),a=e[0].match(/:(.*?);/)[1],r=atob(e[1]),i=r.length,n=new Uint8Array(i);while(i--)n[i]=r.charCodeAt(i);return new Blob([n],{type:a})},upload:function(){var t=this;if(this.up)return!1;var e={browse_button:this.$refs.upload,multi_selection:!1,max_file_size:"20mb"};this.up=new c["a"](e),this.up.bind("FileUploaded",function(e,a,r){t.list[t.listIndex].src="".concat(e.domain).concat(JSON.parse(r.response||r).key),t.list[t.listIndex].uploaded=!0,t.listIndex<t.list.length&&(t.listIndex+=1,t.nextUpload())}),this.up.init()},showUploadQrcode:function(){this.changeUploadQrcode({show:!0})},replaceImage:function(t){var e=this,a=canvas.getActiveObjects();if(0!==a.length)if(a.length>1)this.$toast.message("只能替换单个素材");else{var r=d()();canvas.getActiveObjects().forEach(function(t){canvas.remove(t)}),canvas.discardActiveObject().renderAll(),u["a"].Image.fromURL(t+"?imageslim&imageView2/0/w/1000",function(t){var i=a[0].scaleX*a[0].width/t.width;t.set(Object(s["a"])({},a[0],{width:t.width,height:t.height,scaleX:i,scaleY:i,_element:t._element,_originalElement:t._originalElement,uid:r})),canvas.add(t),canvas.setActiveObject(t),e.updateHistory()},{crossOrigin:"anonymous"})}else this.$toast.message("请先选中被替换的素材")},addImage:function(t){var e=this;console.log(t);var a=d()();u["a"].Image.fromURL(t+"?imageslim&imageView2/0/w/1000",function(t){t.set({uid:a}),canvas.add(t),canvas.setActiveObject(t),e.updateHistory()},{crossOrigin:"anonymous"})}}),mounted:function(){this.upload()},computed:Object(s["a"])({},Object(o["c"])({confirm:function(t){return t.modal.uploadedMaterial.confirm}}))},m=p,h=(a("94b8"),a("17cc")),f=Object(h["a"])(m,r,i,!1,null,"5d5edb48",null);e["default"]=f.exports},"4b32":function(t,e){t.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAASABIAAD/4QBMRXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/8AAEQgAFAAUAwERAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/bAEMAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/bAEMBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/dAAQAA//aAAwDAQACEQMRAD8A+N/+CTH/AASYuv8Agq7dftF319+0XcfBa9+C1x8Lrq7vLr4XSfFe68aXXxXk+Jk1xc3NxN8Tfh/LpVxpUvw/eWaaV9ak1eTWmd2sWsSb8A/ZD/iEc/6yB/8AmqP/AOUrQB/Hro3jTxj4ctZLHw94s8TaDZS3D3Utno2u6rpdrJdPHFC9zJb2N3bxPcPFBDE8zIZGjhiQsVRAoB//0Psj/g0b/wCcgn/dqX/vydAH9mFAH+M/QB//0f5vfGmjWvhzxj4s8PWMlxLZaD4m13RrSW6eOS6ktdL1S6sbeS5eGKCJ7h4oEaZ4oIY2kLFIo1IRQDmaAPrz4A/AHwd8VPB2peIfEOpeJrO9s/E15o0UWjXulW1q1rb6Xo18kkiX2jajKbgy6jMrus6RmNYgIlZXdwD/2Q=="},5428:function(t,e,a){var r=a("05ba"),i=a("97c1");function n(t,e,a){var n=e&&a||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null),t=t||{};var s=t.random||(t.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var o=0;o<16;++o)e[n+o]=s[o];return e||i(s)}t.exports=n},"94b8":function(t,e,a){"use strict";var r=a("2ad4"),i=a.n(r);i.a},"97c1":function(t,e){for(var a=[],r=0;r<256;++r)a[r]=(r+256).toString(16).substr(1);function i(t,e){var r=e||0,i=a;return[i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]]].join("")}t.exports=i},fd9e:function(t,e,a){"use strict";var r=[a("4b32")],i=new Image;i.src=r[0],fabric.Object.prototype.setControlsVisibility({tl:!1,tr:!1,bl:!1,br:!1,ml:!1,mt:!1,mr:!1,mb:!1,mtr:!0}),fabric.Object.prototype.set({borderOpacityWhenMoving:.5,borderColor:"#333",borderDashArray:[10,10],borderScaleFactor:2,transparentCorners:!0,cornerStrokeColor:"#333",cornerSize:25,lockScalingFlip:!0,lockUniScaling:!0}),fabric.Object.prototype._drawControl=function(t,e,a,r,n,s){if(s=s||{},this.isControlVisible(t)){var o=this.cornerSize;!this.transparentCorners&&this.cornerStrokeColor;e.drawImage(i,r,n,o,o)}},e["a"]=fabric}}]);