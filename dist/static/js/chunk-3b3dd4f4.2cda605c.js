(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b3dd4f4","chunk-31631b6a","chunk-5e04f6b8"],{"05ba":function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var o=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0===(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}},"09ed":function(t,e,n){},"37ea":function(t,e,n){},"3c6b":function(t,e,n){"use strict";var i=n("a013"),o=n("b146"),a=n("b0f4"),s=n("35dd");n("629c")("match",1,function(t,e,n,r){return[function(n){var i=t(this),o=void 0==n?void 0:n[e];return void 0!==o?o.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=r(n,t,this);if(e.done)return e.value;var c=i(t),d=String(this);if(!c.global)return s(c,d);var l=c.unicode;c.lastIndex=0;var u,g=[],v=0;while(null!==(u=s(c,d))){var h=String(u[0]);g[v]=h,""===h&&(c.lastIndex=a(d,o(c.lastIndex),l)),v++}return 0===v?null:g}]})},4964:function(t,e,n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function o(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(t){return i(t)||o(t)||a()}n.d(e,"a",function(){return s})},5428:function(t,e,n){var i=n("05ba"),o=n("97c1");function a(t,e,n){var a=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null),t=t||{};var s=t.random||(t.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var r=0;r<16;++r)e[a+r]=s[r];return e||o(s)}t.exports=a},"97c1":function(t,e){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);function o(t,e){var i=e||0,o=n;return[o[t[i++]],o[t[i++]],o[t[i++]],o[t[i++]],"-",o[t[i++]],o[t[i++]],"-",o[t[i++]],o[t[i++]],"-",o[t[i++]],o[t[i++]],"-",o[t[i++]],o[t[i++]],o[t[i++]],o[t[i++]],o[t[i++]],o[t[i++]]].join("")}t.exports=o},bc60:function(t,e,n){"use strict";n.r(e);var i,o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("infinite-scroll",{ref:"goods",staticClass:"good-list",attrs:{loadMore:t.loadMore}},[t._l(t.goodsList,function(e,i){return n("div",{staticClass:"goods-body"},[n("div",{key:e.goods_id,staticClass:"good-item",on:{click:function(n){return t.openGoodDetail(e.goods_id,e.key,"goodsList")}}},[n("div",{staticClass:"good-btns"},[n("div",{staticClass:"good-btn",on:{click:function(n){return n.stopPropagation(),t.replaceImage(e.original_img,e)}}},[t._v("替换")]),n("div",{staticClass:"good-btn",on:{click:function(n){return n.stopPropagation(),t.addImage(e.original_img,e)}}},[t._v("添加")])]),n("div",{staticClass:"good-img",style:{"background-image":"url("+e.original_img+"?imageslim&imageView2/0/w/560)"},attrs:{id:e.goods_id,type:"good",source:"goodsList"}}),n("div",{staticClass:"good-cell"},[n("div",{staticClass:"good-money-vip"},[n("em",[t._v("¥"+t._s(e.shop_price))]),n("span",[t._v("会员")])]),e.is_collection?n("i",{staticClass:"icon-collection_active",on:{click:function(e){return e.stopPropagation(),t.collectionGood(i)}}}):n("i",{staticClass:"icon-collection",on:{click:function(e){return e.stopPropagation(),t.collectionGood(i)}}})]),n("div",{staticClass:"good-money"},[n("span",[t._v("零售价")]),n("em",[t._v("¥"+t._s(e.market_price))])]),n("p",{staticClass:"good-name"},[t._v(t._s(e.goods_name))])])])}),t.goodsList.length?t._e():n("div",{staticClass:"good-list-info"},[t._v("暂无收藏的商品")])],2)},a=[],s=(n("608b"),n("3c6b"),n("f763"),n("4964")),r=(n("4453"),n("089b")),c=n("e20c"),d=n("fd88"),l=n("880a"),u=n("591a"),g=n("5428"),v=n.n(g),h={name:"collectionGoods",data:function(){return{eventList:{TOUCH_START:this.isMobile()?"touchstart":"mousedown",TOUCH_MOVE:this.isMobile()?"touchmove":"mousemove",TOUCH_END:this.isMobile()?"touchend":"mouseup"},goodsList:[],pageCode:0,collectionStatus:!1,isLoading:!1,isLoaded:!1}},methods:Object(c["a"])({},Object(u["b"])(["changeSkuDetail","changeSketchGoods","updateHistory"]),{getGoodsList:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$axios.get(l["collectionSKU"]);case 3:e=t.sent,n=e.data,this.isLoading=!1,this.isLoaded=!1,this.pageCode=0,this.moreCates=n.c_list,this.pageCode=n.page_code,this.goodsList=n.ls,this.collectionStatus=!1,t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](0),i=t.t0.msg,this.$toast.error(i);case 18:case"end":return t.stop()}},t,this,[[0,14]])}));function e(){return t.apply(this,arguments)}return e}(),loadMore:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n,i,o,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!this.isLoading&&!this.isLoaded){t.next=3;break}return t.abrupt("return");case 3:return this.isLoading=!0,t.next=6,this.$axios.get(l["collectionSKU"],{params:{page_code:this.pageCode}});case 6:n=t.sent,i=n.data,this.pageCode=i.page_code,(e=this.goodsList).push.apply(e,Object(s["a"])(i.ls)),this.isLoaded=!i.ls.length,this.$nextTick(function(){a.isLoading=!1}),t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](0),o=t.t0.msg,this.isLoading=!1,this.$toast.error(o);case 19:case"end":return t.stop()}},t,this,[[0,14]])}));function e(){return t.apply(this,arguments)}return e}(),collectionGood:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var n,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!this.collectionStatus){t.next=3;break}return t.abrupt("return");case 3:if(this.collectionStatus=!0,n=this.goodsList[e],!n.is_collection){t.next=10;break}return t.next=8,this.$axios.get(l["unCollection"],{params:{goods_id:n.goods_id}});case 8:t.next=12;break;case 10:return t.next=12,this.$axios.get(l["setCollection"],{params:{goods_id:n.goods_id}});case 12:this.$set(n,"is_collection",!n.is_collection),this.getGoodsList(),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](0),i=t.t0.msg,this.$toast.error(i);case 20:case"end":return t.stop()}},t,this,[[0,16]])}));function e(e){return t.apply(this,arguments)}return e}(),openGoodDetail:function(t,e,n){this.changeSkuDetail({show:!0,id:t,key:e,dataSource:n})},replaceImage:function(t,e){var n=this;if(this.matrix.show)this.$toast.message("请先取消变形");else{var i=canvas.getActiveObjects();if(0!==i.length)if(i.length>1)this.$toast.message("只能替换单个商品");else if("i-text"!==i[0].type){var o=v()();canvas.getActiveObjects().forEach(function(t){t.goods_id&&n.changeSketchGoods({type:"remove",uid:t.uid}),canvas.remove(t)}),canvas.discardActiveObject().renderAll(),fabric.Image.fromURL(t+"?imageslim&imageView2/0/w/1000",function(t){var a=i[0].scaleX*i[0].width/t.width,s=Object(c["a"])({},i[0],{width:t.width,height:t.height,scaleX:a,scaleY:a,_element:t._element,_originalElement:t._originalElement,goods_id:e.goods_id,goods_key:e.key,uid:o});t.set(Object(c["a"])({},s)),canvas.add(t),canvas.setActiveObject(t),n.changeSketchGoods({type:"set",good:Object(c["a"])({},e,{uid:o})}),n.updateHistory()},{crossOrigin:"anonymous"})}else this.$toast.message("文本不能被替换");else this.$toast.message("请先选中被替换的单品")}},addImage:function(t,e){var n=this,i=v()();fabric.Image.fromURL(t+"?imageslim&imageView2/0/w/1000",function(t){t.set({goods_id:e.goods_id,goods_key:e.key,left:100,top:100,uid:i}),t.scaleToWidth(300),canvas.add(t),canvas.setActiveObject(t),n.changeSketchGoods({type:"set",good:Object(c["a"])({},e,{uid:i})}),n.updateHistory()},{crossOrigin:"anonymous"})},isMobile:function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},initDrag:function(){var t=this,e=new CustomEvent("mydragstart"),n=new CustomEvent("mydragend");this.$refs.goods.$el.addEventListener(this.eventList.TOUCH_START,function(o){if(o.cancelable&&-1!==o.target.className.indexOf("good-img")){clearInterval(i);var a=500,s=t.isMobile()?o.changedTouches[0]:o,r=null,d=o.target,l=d.getBoundingClientRect(),u=!1,g=null;i=setTimeout(function(){window.dispatchEvent(e),r=d.cloneNode(!0),r.style.width=d.offsetWidth+"px",r.style.height=d.offsetHeight+"px",r.style.position="fixed",r.style.left=l.left+"px",r.style.top=l.top+"px",r.style.pointerEvents="none",r.style.transition="transform .3s",document.body.appendChild(r),setTimeout(function(){r.style.transform="scale(1.2)"},50);var n=function t(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.target.removeEventListener("click",t)},i=function(t){t.preventDefault()},o=function e(n){n.preventDefault(),n.target.removeEventListener(t.eventList.TOUCH_MOVE,i),n.target.removeEventListener(t.eventList.TOUCH_END,e)};d.addEventListener("click",n),d.addEventListener(t.eventList.TOUCH_MOVE,i),d.addEventListener(t.eventList.TOUCH_END,o)},a);var v=function(e){var n=t.isMobile()?e.changedTouches[0]:e;(Math.abs(n.clientX-s.clientX)>30||Math.abs(n.clientY-s.clientY)>30)&&clearInterval(i),requestAnimationFrame(function(){if(r){e.preventDefault();var n=t.isMobile()?e.changedTouches[0]:e,i=document.createEvent("Event");i.initEvent("myDragover",!0,!0),g=document.elementFromPoint(n.pageX,n.pageY),g&&g.dispatchEvent(i),u=i.defaultPrevented,r.style.left=Math.round(n.pageX-(s.pageX-l.left))+"px",r.style.top=Math.round(n.pageY-(s.pageY-l.top))+"px"}})};document.addEventListener(t.eventList.TOUCH_MOVE,v),document.addEventListener(t.eventList.TOUCH_END,function(e){if(clearInterval(i),document.removeEventListener(t.eventList.TOUCH_MOVE,v),r){if(e.preventDefault(),u){var o=document.createEvent("Event");o.initEvent("myDrop",!0,!0);var a=t.isMobile()?e.changedTouches[0]:e,s=d.getAttribute("source"),l={};l=t[s].find(function(t){return parseInt(d.getAttribute("id"))===t.goods_id}),o["pageX"]=a.pageX,o["pageY"]=a.pageY,o["data"]=Object(c["a"])({type:d.getAttribute("type"),url:l.original_img},l),g.dispatchEvent(o)}document.body.removeChild(r),r=null,window.dispatchEvent(n)}})}})},handleTouchstart:function(t,e){var n=this;clearInterval(i),i=setTimeout(function(){t.preventDefault(),n.$set(e,"longtouch",!0)},500)},handleTouchend:function(t,e){clearInterval(i),e.longtouch&&(t.preventDefault(),this.$set(e,"longtouch",!1))}}),created:function(){this.getGoodsList()},mounted:function(){this.initDrag()},computed:Object(c["a"])({},Object(u["c"])({matrix:function(t){return t.sketch.matrix}})),components:{infiniteScroll:d["a"]}},f=h,p=(n("fe78"),n("17cc")),m=Object(p["a"])(f,o,a,!1,null,"67d72e89",null);e["default"]=m.exports},c2f0:function(t,e,n){"use strict";var i=n("37ea"),o=n.n(i);o.a},fd88:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"scroller",attrs:{id:"scroller"}},[t._t("default")],2)},o=[],a=(n("d4d5"),{name:"infiniteScroll",props:{distance:{type:Number,default:100},loadMore:{type:Function,required:!0}},methods:{initScroller:function(){var t=this,e=this.$refs.scroller;e.addEventListener("scroll",function(n){var i=e.scrollHeight,o=e.scrollTop,a=e.offsetHeight;i-o-a<100&&t.loadMore()})}},mounted:function(){this.initScroller()}}),s=a,r=(n("c2f0"),n("17cc")),c=Object(r["a"])(s,i,o,!1,null,"0355fe16",null);e["a"]=c.exports},fe78:function(t,e,n){"use strict";var i=n("09ed"),o=n.n(i);o.a}}]);