(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d796e55"],{ae22:function(e,t,s){},c66b:function(e,t,s){"use strict";s.r(t);var i,o,n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"goods-slider"},[e.showBackTop?i("div",{staticClass:"back-top",on:{click:e.scrollToTop}},[i("i",{staticClass:"icon-up-1"})]):e._e(),e.menu.length?i("div",{staticClass:"goods-menu"},[i("span",{on:{click:function(t){return e.selectMenu(-1)}}},[e._v("品类")]),e._l(e.menu,function(t,s){return i("span",{class:{active:s===e.menu.length-1},on:{click:function(t){return e.selectMenu(s)}}},[e._v(e._s(t.name))])})],2):e._e(),!e.menu.length&&e.keyword?i("div",{staticClass:"goods-menu"},[i("span",{on:{click:function(t){return e.selectMenu(-1,"all")}}},[e._v("全部分类")]),i("span",{staticClass:"active"},[e._v("搜索结果")])]):e._e(),i("infinite-scroll",{ref:"goods",staticClass:"goods-scroller",attrs:{loadMore:e.loadMore}},[e.categoriesList.length?i("div",{staticClass:"goods-cates"},e._l(e.categoriesList,function(t){return i("div",{staticClass:"goods-cate",on:{click:function(s){return e.selectCate(t)}}},[i("touch-ripple",{attrs:{speed:3,opacity:.6}},[i("span",[e._v(e._s(t.name))])])],1)}),0):e._e(),i("div",{staticClass:"filter"},[i("div",{staticClass:"select"},[i("div",{staticClass:"select-value",on:{click:function(t){return t.stopPropagation(),e.toggleSpaceSelect(t)}}},[e._v(e._s(e.selectedSpace||"选择空间")),i("div",{directives:[{name:"show",rawName:"v-show",value:e.spaceSelect,expression:"spaceSelect"}],staticClass:"select-dropdown"},[i("div",{staticClass:"select-option",on:{click:function(t){return e.selectSpace("")}}},[e._v("全部")]),e._l(e.spaceList,function(t){return i("div",{staticClass:"select-option",class:{active:e.selectedSpace===t.name},on:{click:function(s){return e.selectSpace(t.name)}}},[e._v(e._s(t.name))])})],2)])]),i("div",{staticClass:"select"},[i("div",{staticClass:"select-value",on:{click:function(t){return t.stopPropagation(),e.toggleStyleSelect(t)}}},[e._v(e._s(e.selectedStyle||"选择风格")),i("div",{directives:[{name:"show",rawName:"v-show",value:e.styleSelect,expression:"styleSelect"}],staticClass:"select-dropdown"},[i("div",{staticClass:"select-option",on:{click:function(t){return e.selectStyle("")}}},[e._v("全部")]),e._l(e.styleList,function(t){return i("div",{staticClass:"select-option",class:{active:e.selectedStyle===t.name},on:{click:function(s){return e.selectStyle(t.name)}}},[e._v(e._s(t.name))])})],2)])]),i("div",{staticClass:"select"},[i("div",{staticClass:"select-value",on:{click:function(t){return t.stopPropagation(),e.toggleSourceSelect(t)}}},[e._v(e._s(e.selectedSource.name||"所有商品来源")),i("div",{directives:[{name:"show",rawName:"v-show",value:e.sourceSelect,expression:"sourceSelect"}],staticClass:"select-dropdown"},[i("div",{staticClass:"select-option",on:{click:function(t){return e.selectSource("")}}},[e._v("所有商品来源")]),e._l(e.sourceList,function(t){return i("div",{staticClass:"select-option",class:{active:e.selectedStyle===t.name},on:{click:function(s){return e.selectSource(t)}}},[e._v(e._s(t.name))])})],2)])])]),i("div",{staticClass:"goods-list"},[e._l(e.goodsList,function(t){return i("div",{staticClass:"goods-body"},[i("div",{key:t.goods_id,staticClass:"good-item",on:{click:function(s){return e.openGoodDetail(t.goods_id,t.key,"goodsList")}}},[i("div",{staticClass:"good-btns"},[i("div",{staticClass:"good-btn",on:{click:function(s){return s.stopPropagation(),e.replaceImage(t.original_img,t)}}},[e._v("替换")]),i("div",{staticClass:"good-btn",on:{click:function(s){return s.stopPropagation(),e.addImage(t.original_img,t)}}},[e._v("添加")])]),i("div",{staticClass:"good-img",style:{"background-image":"url("+t.original_img+"?imageslim&imageView2/0/w/560)"},attrs:{id:t.goods_id,type:"good",source:"goodsList"}}),i("div",{staticClass:"good-cell"},[i("div",{staticClass:"good-money-vip"},[i("em",[e._v("¥"+e._s(t.shop_price))]),i("span",[e._v("会员")])]),t.is_collection?i("i",{staticClass:"icon-collection_active",on:{click:function(s){return s.stopPropagation(),e.collectionGood(t)}}}):i("i",{staticClass:"icon-collection",on:{click:function(s){return s.stopPropagation(),e.collectionGood(t)}}})]),i("div",{staticClass:"good-money"},[i("span",[e._v("零售价")]),i("em",[e._v("¥"+e._s(t.market_price))])]),i("p",{staticClass:"good-name"},[e._v(e._s(t.goods_name))])])])}),e.isEmpty?i("div",{staticClass:"empty"},[i("img",{attrs:{src:s("d363")}}),i("p",[e._v("未找到相关商品")])]):e._e()],2)])],1)},a=[],c=(s("608b"),s("3c6b"),s("f763"),s("4964")),r=(s("4453"),s("089b")),l=s("e20c"),d=(s("7364"),s("34a3"),s("fd88")),u=s("880a"),g=s("591a"),h=s("5428"),p=s.n(h),v={name:"goodList",props:{keyword:String},data:function(){return{eventList:{TOUCH_START:this.isMobile()?"touchstart":"mousedown",TOUCH_MOVE:this.isMobile()?"touchmove":"mousemove",TOUCH_END:this.isMobile()?"touchend":"mouseup"},categoriesList:[],menu:[],goodsList:[],pageCode:0,inited:!1,isEmpty:!1,isLoading:!1,isLoaded:!1,sourceList:[{name:"直供商品",value:"plat"},{name:"本地馆商品",value:"shop"}],spaceSelect:!1,styleSelect:!1,sourceSelect:!1,selectedStyle:"",selectedSpace:"",selectedSource:{},showBackTop:!1}},watch:{$route:function(){var e=this;clearTimeout(i),i=setTimeout(function(){e.getGoodsList()},300)},keyword:function(e){var t=this;clearTimeout(i),i=setTimeout(function(){e?t.getGoodsList():t.$router.replace({name:t.$route.name,query:{tm:(new Date).getTime()}})},600)}},methods:Object(l["a"])({},Object(g["b"])(["changeSkuDetail","changeSketchGoods","updateHistory"]),{selectMenu:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("all"===t)this.setKeyword(""),this.$router.replace({name:this.$route.name,query:{tm:(new Date).getTime()}});else{if(this.menu.length===e+1)return;-1===e?(this.setKeyword(""),this.$router.replace({name:this.$route.name,query:{tm:(new Date).getTime()}})):(this.menu.splice(e+1,this.menu.length),this.$router.replace({name:this.$route.name,query:Object(l["a"])({},this.$route.query,{category_id:this.menu[e].id})}))}},selectCate:function(e){this.menu.push(e),this.$router.replace({name:this.$route.name,query:Object(l["a"])({},this.$route.query,{category_id:e.id})})},selectSpace:function(e){this.selectedSpace=e,this.getGoodsList()},selectStyle:function(e){this.selectedStyle=e,this.getGoodsList()},selectSource:function(e){this.selectedSource=e,this.getGoodsList()},toggleSpaceSelect:function(){this.spaceSelect=!this.spaceSelect},toggleStyleSelect:function(){this.styleSelect=!this.styleSelect},toggleSourceSelect:function(){this.sourceSelect=!this.sourceSelect},setKeyword:function(e){this.$emit("setKeyword",e)},getGoodsList:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.get(u["searchSKU"],{params:Object(l["a"])({},this.$route.query,{goods_from:this.selectedSource.value,style_words:this.selectedStyle,space_words:this.selectedSpace,search_words:this.keyword})});case 3:t=e.sent,s=t.data,this.isEmpty=!s.ls.length,this.isLoading=!1,this.isLoaded=!1,this.pageCode=0,this.categoriesList=s.c_list,!this.menu.length&&s.c_path.cat_id&&(this.menu=[{id:s.c_path.cat_id,name:s.c_path.cat_name}]),this.pageCode=s.page_code,this.goodsList=s.ls,this.inited=!0,e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](0),i=e.t0.msg,this.$toast.error(i);case 20:case"end":return e.stop()}},e,this,[[0,16]])}));function t(){return e.apply(this,arguments)}return t}(),loadMore:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,s,i,o,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isLoading&&!this.isLoaded){e.next=3;break}return e.abrupt("return");case 3:return this.isLoading=!0,e.next=6,this.$axios.get(u["searchSKU"],{params:Object(l["a"])({},this.$route.query,{goods_from:this.selectedSource.value,style_words:this.selectedStyle,space_words:this.selectedSpace,search_words:this.keyword,page_code:this.pageCode})});case 6:s=e.sent,i=s.data,this.pageCode=i.page_code,(t=this.goodsList).push.apply(t,Object(c["a"])(i.ls)),i.ls.length||(this.isLoaded=!0),this.$nextTick(function(){n.isLoading=!1}),e.next=19;break;case 14:e.prev=14,e.t0=e["catch"](0),o=e.t0.msg,this.isLoading=!1,this.$toast.error(o);case 19:case"end":return e.stop()}},e,this,[[0,14]])}));function t(){return e.apply(this,arguments)}return t}(),collectionGood:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var s,i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,s=t.is_collection,i=t.goods_id,!s){e.next=7;break}return e.next=5,this.$axios.get(u["unCollection"],{params:{goods_id:i}});case 5:e.next=9;break;case 7:return e.next=9,this.$axios.get(u["setCollection"],{params:{goods_id:i}});case 9:this.$set(t,"is_collection",!s),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](0),o=e.t0.msg,this.$toast.error(o);case 16:case"end":return e.stop()}},e,this,[[0,12]])}));function t(t){return e.apply(this,arguments)}return t}(),openGoodDetail:function(e,t,s){this.changeSkuDetail({show:!0,id:e,key:t,dataSource:s})},replaceImage:function(e,t){var s=this;if(this.matrix.show)this.$toast.message("请先取消变形");else{var i=canvas.getActiveObjects();if(0!==i.length)if(i.length>1)this.$toast.message("只能替换单个商品");else if("i-text"!==i[0].type){var o=p()();canvas.getActiveObjects().forEach(function(e){e.goods_id&&s.changeSketchGoods({type:"remove",uid:e.uid}),canvas.remove(e)}),canvas.discardActiveObject().renderAll(),fabric.Image.fromURL(e+"?imageslim&imageView2/0/w/1000",function(e){var n=i[0].scaleX*i[0].width/e.width,a=Object(l["a"])({},i[0],{width:e.width,height:e.height,scaleX:n,scaleY:n,_element:e._element,_originalElement:e._originalElement,goods_id:t.goods_id,goods_key:t.key,uid:o});e.set(Object(l["a"])({},a)),canvas.add(e),canvas.setActiveObject(e),s.changeSketchGoods({type:"set",good:Object(l["a"])({},t,{uid:o})}),s.updateHistory()},{crossOrigin:"anonymous"})}else this.$toast.message("文本不能被替换");else this.$toast.message("请先选中被替换的单品")}},addImage:function(e,t){var s=this,i=p()();fabric.Image.fromURL(e+"?imageslim&imageView2/0/w/1000",function(e){e.set({goods_id:t.goods_id,goods_key:t.key,left:100,top:100,uid:i}),e.scaleToWidth(300),canvas.add(e),canvas.setActiveObject(e),s.changeSketchGoods({type:"set",good:Object(l["a"])({},t,{uid:i})}),s.updateHistory()},{crossOrigin:"anonymous"})},isMobile:function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},initDrag:function(){var e=this,t=new CustomEvent("mydragstart"),s=new CustomEvent("mydragend");this.$refs.goods.$el.addEventListener(this.eventList.TOUCH_START,function(i){if(i.cancelable&&-1!==i.target.className.indexOf("good-img")){clearInterval(o);var n=500,a=e.isMobile()?i.changedTouches[0]:i,c=null,r=i.target,d=r.getBoundingClientRect(),u=!1,g=null;o=setTimeout(function(){window.dispatchEvent(t),c=r.cloneNode(!0),c.style.width=r.offsetWidth+"px",c.style.height=r.offsetHeight+"px",c.style.position="fixed",c.style.left=d.left+"px",c.style.top=d.top+"px",c.style.pointerEvents="none",c.style.transition="transform .3s",document.body.appendChild(c),setTimeout(function(){c.style.transform="scale(1.2)"},50);var s=function e(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,t.target.removeEventListener("click",e)},i=function(e){e.preventDefault()},o=function t(s){s.preventDefault(),s.target.removeEventListener(e.eventList.TOUCH_MOVE,i),s.target.removeEventListener(e.eventList.TOUCH_END,t)};r.addEventListener("click",s),r.addEventListener(e.eventList.TOUCH_MOVE,i),r.addEventListener(e.eventList.TOUCH_END,o)},n);var h=function(t){var s=e.isMobile()?t.changedTouches[0]:t;(Math.abs(s.clientX-a.clientX)>30||Math.abs(s.clientY-a.clientY)>30)&&clearInterval(o),requestAnimationFrame(function(){if(c){t.preventDefault();var s=e.isMobile()?t.changedTouches[0]:t,i=document.createEvent("Event");i.initEvent("myDragover",!0,!0),g=document.elementFromPoint(s.pageX,s.pageY),g&&g.dispatchEvent(i),u=i.defaultPrevented,c.style.left=Math.round(s.pageX-(a.pageX-d.left))+"px",c.style.top=Math.round(s.pageY-(a.pageY-d.top))+"px"}})};document.addEventListener(e.eventList.TOUCH_MOVE,h),document.addEventListener(e.eventList.TOUCH_END,function(t){if(clearInterval(o),document.removeEventListener(e.eventList.TOUCH_MOVE,h),c){if(t.preventDefault(),u){var i=document.createEvent("Event");i.initEvent("myDrop",!0,!0);var n=e.isMobile()?t.changedTouches[0]:t,a=r.getAttribute("source"),d={};d=e[a].find(function(e){return parseInt(r.getAttribute("id"))===e.goods_id}),i["pageX"]=n.pageX,i["pageY"]=n.pageY,i["data"]=Object(l["a"])({type:r.getAttribute("type"),url:d.original_img},d),g.dispatchEvent(i)}document.body.removeChild(c),c=null,window.dispatchEvent(s)}})}})},handleTouchstart:function(e,t){var s=this;clearInterval(o),o=setTimeout(function(){e.preventDefault(),s.$set(t,"longtouch",!0)},500)},handleTouchend:function(e,t){clearInterval(o),t.longtouch&&(e.preventDefault(),this.$set(t,"longtouch",!1))},watchScroller:function(){var e=this,t=this.$refs.goods.$el;t.addEventListener("scroll",function(){var t=e.$refs.goods.$el,s=t.scrollTop,i=t.offsetHeight;e.showBackTop=s>=2*i})},scrollToTop:function(){var e=this.$refs.goods.$el;e.scrollTop=0}}),created:function(){var e=this.$route.query,t=e.style_words,s=void 0===t?"":t,i=e.space_words,o=void 0===i?"":i;this.selectedStyle=s,this.selectedSpace=o,this.getGoodsList()},mounted:function(){var e=this;this.initDrag(),this.watchScroller(),document.addEventListener("click",function(){e.spaceSelect=!1,e.styleSelect=!1,e.sourceSelect=!1})},computed:Object(l["a"])({},Object(g["c"])({matrix:function(e){return e.sketch.matrix},styleList:function(e){return e.sketch.styleList},spaceList:function(e){return e.sketch.spaceList}})),components:{infiniteScroll:d["a"]}},m=v,f=(s("f8ec"),s("17cc")),_=Object(f["a"])(m,n,a,!1,null,"d4e4d57a",null);t["default"]=_.exports},d363:function(e,t,s){e.exports=s.p+"static/img/search_img_notf_dis.097ce81b.png"},f8ec:function(e,t,s){"use strict";var i=s("ae22"),o=s.n(i);o.a}}]);