(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61730640","chunk-70219516"],{"08fd":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modify-pop-body"},[s("div",{staticClass:"goods-detail-img"},[s("div",{staticClass:"goods-photo"},[s("img",{attrs:{src:e.selectedSpec.spec_img||e.goods.original_img}})])]),s("div",{staticClass:"goods-detail-body"},[s("div",{staticClass:"icon-close",on:{click:e.close}}),s("div",{staticClass:"goods-price"},[e._v("¥"+e._s(e.selectedSpec.hasDiscount?e.selectedSpec.shop_price:e.selectedSpec.old_shop_price))]),s("div",{staticClass:"goods-spec-items"},e._l(e.goods.spec,function(t,i){return s("div",{staticClass:"spec-item"},[s("div",{staticClass:"spec-item-label"},[e._v(e._s(t.name)+"：")]),s("div",{staticClass:"spec-item-content"},e._l(t.spec_item,function(t,c){return s("div",{staticClass:"spec-item-value",class:{active:e.specKeysMap[i]==t.id},on:{click:function(s){return e.selectSpec(i,t.id)}}},[t.src?s("img",{attrs:{src:t.src}}):e._e(),s("span",[e._v(e._s(t.item))])])}),0)])}),0),s("div",{staticClass:"goods-detail-handle",on:{click:e.confirm}},[e._v("确认修改")])])])},c=[],o=(s("b745"),s("4964")),r=(s("608b"),s("3d92")),n=(s("f763"),s("7bc1"),{name:"specSelect",props:{goods:{type:Object,required:!0}},data:function(){return{selectedNumber:1,specKeysMap:[],selectedSpec:{spec_img:"",min_count:1,store_count:1}}},watch:{goods:function(){this.init()}},methods:{getSpecKeysMap:function(){var e=[],t=this.goods.selectedSpec.spec_key.split("_");this.goods.spec.forEach(function(s,i){for(var c=function(c){var o=s.spec_item[c];if(t.find(function(e){return parseInt(o.id)===parseInt(e)}))return e[i]=o.id,{v:!1}},o=0;o<s.spec_item.length;o++){var n=c(o);if("object"===Object(r["a"])(n))return n.v}}),this.specKeysMap=e},selectSpec:function(e,t){this.specKeysMap[e]=t;var s=Object(o["a"])(this.specKeysMap),i=s.sort(function(e,t){return e-t}).join("_");this.selectedSpec=this.goods.spec_value.find(function(e){return e.spec_key===i})},confirm:function(){this.selectedSpec.selectedNumber=this.selectedNumber,this.$emit("confirm",this.selectedSpec),this.close()},close:function(){this.$emit("close")}},created:function(){this.selectedSpec=this.goods.selectedSpec,this.getSpecKeysMap()}}),a=n,l=(s("09bc"),s("17cc")),d=Object(l["a"])(a,i,c,!1,null,"c4ba172e",null);t["default"]=d.exports},"09bc":function(e,t,s){"use strict";var i=s("b1d6"),c=s.n(i);c.a},"119c":function(e,t,s){"use strict";var i=s("b6f1");e.exports=function(e,t){return!!e&&i(function(){t?e.call(null,function(){},1):e.call(null)})}},"3d92":function(e,t,s){"use strict";function i(e){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function c(e){return c="function"===typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)},c(e)}s.d(t,"a",function(){return c})},4964:function(e,t,s){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,s=new Array(e.length);t<e.length;t++)s[t]=e[t];return s}}function c(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function r(e){return i(e)||c(e)||o()}s.d(t,"a",function(){return r})},"4f36":function(e,t,s){},"799e":function(e,t,s){"use strict";var i=s("4f36"),c=s.n(i);c.a},a014:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"detail"},[s("div",{staticClass:"detail-body"},[s("div",{staticClass:"detail-scroller"},[s("div",{staticClass:"preview"},[e.detail.img_url?s("div",{staticClass:"preview-cover",style:{"background-image":"url("+e.detail.img_url+")"}}):e._e(),s("div",{staticClass:"preview-wrapper"},[s("div",{staticClass:"preview-title"},[e._v(e._s(e.detail.name))]),s("div",{staticClass:"preview-subtitle"},[e._v(e._s(e.detail.brief_introduction))]),s("div",{staticClass:"preview-sub"},[e.hasDiscount?s("div",{staticClass:"preview-sub-name"},[e._v("优惠价")]):e._e(),s("div",{staticClass:"preview-sub-wrapper"},[s("div",{staticClass:"preview-sub-price"},[e._v("¥"+e._s(e.hasDiscount?e.price.totalPrice:e.price.oldTotalPrice))]),e.hasDiscount?s("div",{staticClass:"preview-sub-tag"},[s("span",[e._v("该组合可省")]),s("em",[e._v(e._s(e.price.oldTotalPrice-e.price.totalPrice)+"元")])]):e._e()])]),e.hasDiscount?s("div",{staticClass:"preview-price"},[e._v("会员价 ¥"+e._s(e.price.oldTotalPrice))]):e._e()])]),s("div",{staticClass:"goods-list-container"},[s("div",{staticClass:"goods-list-header"},[s("span",{staticClass:"goods-list-title"},[e._v("单品列表")]),s("span",{staticClass:"goods-list-total"},[e._v("共"+e._s(e.totalGoodsNumber)+"款商品")])]),s("div",{staticClass:"goods-list"},e._l(e.detail.goods,function(t,i){return s("router-link",{staticClass:"goods-item",attrs:{to:{name:"goodDetail",params:{id:t.goods_id}}}},[s("div",{staticClass:"goods-item-cover",style:{"background-image":"url("+t.original_img+")"}}),s("div",{staticClass:"goods-item-wrapper"},[s("div",{staticClass:"goods-item-top"},[s("div",{staticClass:"goods-item-header"},[s("div",{staticClass:"goods-item-title"},[e._v(e._s(t.goods_name))]),s("div",{staticClass:"goods-item-menu",on:{click:function(e){e.preventDefault()}}},[s("mu-menu",{attrs:{"popover-class":"sketch-list-popover",placement:"bottom-end",open:t.specSelectShow},on:{"update:open":function(s){return e.$set(t,"specSelectShow",s)}}},[s("div",{staticClass:"goods-item-handle"},[e._v("修改")]),s("div",{staticClass:"mu-menu-content",attrs:{slot:"content"},slot:"content"},[s("spec-select",{attrs:{goods:t},on:{close:function(t){return e.closeSpecSelect(i)},confirm:function(t){return e.confirmSpecSelect(t,i)}}})],1)])],1)]),s("div",{staticClass:"goods-item-spec"},[e._v(e._s(t.selectedSpec.key_name))])]),s("div",{staticClass:"goods-item-bottom"},[s("div",{staticClass:"goods-item-price"},[s("div",{staticClass:"goods-item-default-price"},[e._v("¥"+e._s(t.selectedSpec.old_shop_price))]),t.selectedSpec.hasDiscount?s("div",{staticClass:"goods-item-offer-price"},[e._v("优惠价¥"+e._s(t.selectedSpec.shop_price))]):e._e()]),s("div",{staticClass:"goods-item-stepper"},[t.selectedSpec.selectedNumber?s("c-number",{attrs:{min:t.selectedSpec.min_count,max:t.selectedSpec.store_count},on:{overlimit:function(s){return e.stepperOverlimit(t.selectedSpec)}},model:{value:t.selectedSpec.selectedNumber,callback:function(s){e.$set(t.selectedSpec,"selectedNumber",s)},expression:"item.selectedSpec.selectedNumber"}}):e._e()],1)])])])}),1)])])]),s("div",{staticClass:"detail-menu"},[s("div",{staticClass:"detail-menu-wrapper"},[s("div",{staticClass:"detail-menu-top"},[s("p",{staticClass:"goods-number"},[s("span",[e._v("共")]),s("em",[e._v(e._s(e.totalGoodsNumber))]),s("span",[e._v("件商品")])]),e.hasDiscount?s("p",{staticClass:"goods-price"},[s("span",[e._v("原价¥"+e._s(e.price.oldTotalPrice))]),s("em",[e._v("共节省 ¥"+e._s(e.price.oldTotalPrice-e.price.totalPrice))])]):e._e()]),s("div",{staticClass:"detail-menu-bottom"},[s("div",{staticClass:"goods-total-price"},[s("span",[e._v("合计：")]),s("em",[e._v("¥"+e._s(e.price.totalPrice))])]),s("div",{staticClass:"submit",on:{click:e.confirm}},[e._v("立即购买")])])])])])},c=[],o=(s("f763"),s("e20c")),r=(s("4453"),s("089b")),n=s("880a"),a=s("08fd"),l={name:"joinShopDetail",data:function(){return{detail:{goods:[]}}},components:{specSelect:a["default"]},computed:{totalGoodsNumber:function(){return this.detail.goods.reduce(function(e,t){return e+t.selectedSpec.selectedNumber},0)},price:function(){return this.detail.goods.reduce(function(e,t){return{oldTotalPrice:e.oldTotalPrice+parseFloat(t.selectedSpec.old_shop_price)*t.selectedSpec.selectedNumber,totalPrice:e.totalPrice+parseFloat(t.selectedSpec.hasDiscount?t.selectedSpec.shop_price:t.selectedSpec.old_shop_price)*t.selectedSpec.selectedNumber}},{oldTotalPrice:0,totalPrice:0})},hasDiscount:function(){return parseFloat(this.price.oldTotalPrice)>parseFloat(this.price.totalPrice)}},methods:{confirm:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,s,i,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=this.detail.goods.map(function(e){var t=e.selectedSpec;return{goods_id:e.goods_id,spec_key:t.spec_key,goods_num:t.selectedNumber}}),e.next=4,this.$axios.post(n["buyList"],{id:this.$route.params.id,goods:JSON.stringify(t)});case 4:s=e.sent,i=s.data,this.$router.push({name:"confirmOrder",query:{from:"joinShop",token:i.token}}),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),c=e.t0.msg,this.$toast.error(c);case 13:case"end":return e.stop()}},e,this,[[0,9]])}));function t(){return e.apply(this,arguments)}return t}(),closeSpecSelect:function(e){this.$set(this.detail.goods[e],"specSelectShow",!1)},confirmSpecSelect:function(e,t){var s=this.detail.goods[t]["selectedSpec"];this.detail.goods[t]["selectedSpec"]=Object(o["a"])({},s,e,{selectedNumber:s.selectedNumber})},stepperOverlimit:function(e){var t=e.selectedNumber,s=e.min_count,i=e.store_count;t===s&&this.$toast.error("已达到该组合所需的最小数量"),t===i&&this.$toast.error("已达到该组合所限的最大数量")},getJoinShopList:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.get(n["joinShopDetail"],{params:{id:this.$route.params.id}});case 3:t=e.sent,s=t.data,s.goods.forEach(function(e){e.specSelectShow=!1,e.spec_value.forEach(function(t){t.hasDiscount=parseFloat(t.old_shop_price)>parseFloat(t.shop_price),1===t.is_default&&(e.selectedSpec=Object(o["a"])({},t),e.selectedSpec["selectedNumber"]=t.min_count)})}),this.detail=s,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),i=e.t0.msg,this.$toast.error(i);case 13:case"end":return e.stop()}},e,this,[[0,9]])}));function t(){return e.apply(this,arguments)}return t}()},beforeRouteEnter:function(e,t,s){s(function(e){e.getJoinShopList()})}},d=l,u=(s("799e"),s("17cc")),p=Object(u["a"])(d,i,c,!1,null,"719845d4",null);t["default"]=p.exports},b1d6:function(e,t,s){},b745:function(e,t,s){"use strict";var i=s("b2f5"),c=s("648a"),o=s("db4b"),r=s("b6f1"),n=[].sort,a=[1,2,3];i(i.P+i.F*(r(function(){a.sort(void 0)})||!r(function(){a.sort(null)})||!s("119c")(n)),"Array",{sort:function(e){return void 0===e?n.call(o(this)):n.call(o(this),c(e))}})}}]);